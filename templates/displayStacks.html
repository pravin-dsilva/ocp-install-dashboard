<!DOCTYPE html>
<html>

<head>
  <!-- Load Bootstrap -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/5.0.0-alpha1/css/bootstrap.min.css"
    integrity="sha384-r4NyP46KrjDleawBgD5tp8Y7UzmLA05oM1iAEQ17CSuDqnUK2+k9luXQOfXJCJ4I" crossorigin="anonymous" />
  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
    integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo"
    crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/5.0.0-alpha1/js/bootstrap.min.js"
    integrity="sha384-oesi62hOLfzrys4LxRF63OJCXdXDipiYWBnvTl9Y9/TRlw5xlKIEHpNyvvDShgf/"
    crossorigin="anonymous"></script>

  <style>
    .float-container {
      padding: 20px;
    }

    .float-child {
      width: 300px;
      float: left;
      margin-top: 10px;
    }

    .button {
      background-color: #4CAF50;
      border: none;
      color: white;
      padding: 15px 32px;
      text-align: center;
      text-decoration: none;
      display: inline-block;
      font-size: 16px;
      margin: 4px 2px;
      cursor: pointer;
    }

    .card-footer-div {
      float: left;
      width: 33%;
      padding: 10px;
      text-align: center;
      cursor: pointer;
    }

    p {
      margin: 0px 0px 0px;
    }


    #refresh-stack-tab,
    #create-cluster-tab,
    #logout {
      padding: 8px 10px;
      background-color: #6988E7;
      border-color: #6988E7;
      white-space: normal;
      color: white;
      letter-spacing: 0.2px;
    }

    #refresh-stack-tab:hover,
    #create-cluster-tab:hover,
    #logout:hover {
      border-color: white !important;
      color: white;

    }
  </style>
  <script>
    var data = '{{ js_data|safe }}';
    var login_data = '{{ login_data|safe }}';
    //var data = '{"Cluster": [{"ID": "71", "ClusterName": "soniatest2", "OcpVersion": "4.6", "Status": "Running"}, {"ID": "70", "ClusterName": "soniatest2", "OcpVersion": "4.6", "Status": "Failed"}, {"ID": "69", "ClusterName": "soniatest1", "OcpVersion": "4.6", "Status": "Failed"}, {"ID": "62", "ClusterName": "Praj-OCP111", "OcpVersion": "4.6", "Status": "Failed"}, {"ID": "49", "ClusterName": "praj-test2", "OcpVersion": "4.5", "Status": "Pending"}]}';
    login_obj = JSON.parse(login_data);
    obj = JSON.parse(data);
    let arr = obj.Cluster;

    function myFunction() {
      document.getElementById("emailid").value = login_obj.emailid;
      console.log(login_obj.emailid);
      for (let i = 0; i < arr.length; i++) {
        var arrayItem = arr[i];
        var el = document.createElement('div');
        var id = "stack" + i;
        status = arrayItem.Status;
        console.log(arrayItem.ClusterName);
        colorCode = getColorCode(status);
        console.log(colorCode);
        imglink = "https:\/\/raw.githubusercontent.com\/sonia-garudi\/icons\/main\/icons\/"
        if (status == "Running") {
          divHTML = "<div class=\"card float-child\" style=\"margin-left:10px; border-color: " + colorCode + " ;\"><div class=\"card-body\" style=\"text-align: center\"><h2 class=\"card-title\">" + arrayItem.ClusterName + "</h2><hr><h6 class=\"card-text\">Running</h6><img src=\"" + imglink + "check-circle.svg\" alt=\"...\"></div><div class=\"card-footer\" style=\"padding:10px\"><div class=\"card-footer-div\" style=\"cursor:auto\" ><form action=\"\"><button style=\"all:unset;\" type=\"submit\"><img src=\"" + imglink + "disableretry.svg\" alt=\"...\"></button></form></div><div class=\"card-footer-div\" data-toggle=\"modal\" data-target=\"#exampleModal\"><button id=\"" + id + "\"  data-title=\"" + arrayItem.ID + "\"  onclick=loadModal(this.id) style=\"all:unset;\"><img src=\"" + imglink + "menu.svg\" alt=\"...\"></button></div><div class=\"card-footer-div\"><form action=\"/delete\" method=\"post\"><input type=\"text\" class=\"form-control d-none\" id=\"clusterid\" name=\"clusterid\" value=\"" + arrayItem.ID + "\"><input type=\"text\" class=\"form-control d-none\" id=\"loginemailid\" name=\"emailid\" placeholder=\"Emailid\" value=\"" + login_obj.emailid + "\"><button style=\"all:unset;\"type=\"submit\" ><img src=\"" + imglink + "x.svg\" alt=\"...\"></button></form></div></div></div>";
        }
        if (status == "Pending") {
          divHTML = "<div class=\"card float-child\" style=\"margin-left:10px; border-color: " + colorCode + ";\"><div class=\"card-body\" style=\"text-align: center\"><h2 class=\"card-title\">" + arrayItem.ClusterName + "</h2><hr><h6 class=\"card-text\">Pending</h6><img src=\"" + imglink + "activity.svg\" alt=\"...\"></div><div class=\"card-footer\" style=\"padding:10px\"><div class=\"card-footer-div\" style=\"cursor:auto\"><form action=\"\"><button style=\"all:unset;\" type=\"submit\" ><img src=\"" + imglink + "disableretry.svg\" alt=\"...\"></button></form></div><div class=\"card-footer-div\" data-toggle=\"modal\" data-target=\"#exampleModal\"><button id=\"" + id + "\" data-title=\"" + arrayItem.ID + "\"  onclick=loadModal(this.id) style=\"all:unset;\"><img src=\"" + imglink + "menu.svg\" alt=\"...\"></button></div><div class=\"card-footer-div\" style=\"cursor:auto\"><form action=\"/delete\"><button style=\"all:unset;\"type=\"submit\" ><img src=\"" + imglink + "disabledelete.svg\" alt=\"...\"></button></form></div></div></div>";
        }
        if (status == "Failed") {
          divHTML = "<div class=\"card float-child\" style=\"margin-left:10px; border-color: " + colorCode + ";\"><div class=\"card-body\" style=\"text-align: center\"><h2 class=\"card-title\">" + arrayItem.ClusterName + "</h2><hr><h6 class=\"card-text\">Failed</h6><img src=\"" + imglink + "alert-circle.svg\" alt=\"...\"></div><div class=\"card-footer\" style=\"padding:10px\"><div class=\"card-footer-div\"><form action=\"\"><button style=\"all:unset;\" type=\"submit\" ><img src=\"" + imglink + "rotate-cw.svg\" alt=\"...\"></button></form></div><div class=\"card-footer-div\" data-toggle=\"modal\" data-target=\"#exampleModal\"><button id=\"" + id + "\" data-title=\"" + arrayItem.ID + "\"  onclick=loadModal(this.id) style=\"all:unset;\"><img src=\"" + imglink + "menu.svg\" alt=\"...\"></button></div><div class=\"card-footer-div\" style=\"cursor:auto\"><form action=\"/delete\" method=\"post\"><input type=\"text\" class=\"form-control d-none\" id=\"clusterid\" name=\"clusterid\" value=\"" + arrayItem.ID + "\"><input type=\"text\" class=\"form-control d-none\" id=\"loginemailid\" name=\"emailid\" placeholder=\"Emailid\" value=\"" + login_obj.emailid + "\"><button style=\"all:unset;\"type=\"submit\" ><img src=\"" + imglink + "x.svg\" alt=\"...\"></button></form></div></div></div>";
        }

        el.innerHTML = divHTML;
        document.getElementById("mainStacksContainer").appendChild(el);
      }
    }

    function loadModal(id) {
      var a = document.getElementById(id);
      var titleData = a.getAttribute("data-title");
      var obj = arr.filter(item => {
        return item.ID === titleData
      })[0];
      if (obj.Status == "Running") { modalBodyHTML = "<br/><p>OCP Version: " + obj.OcpVersion + "</p><p>Cluster Status: " + obj.Status + "</p><p>Console URL: <a href=\"" + obj.console_url + "\" target=\"_blank\">" + obj.console_url + "</a></p><p>Cluster ID: " + obj.ID + "</p>" }
      else { modalBodyHTML = "<br/><p>OCP Version: " + obj.OcpVersion + "</p><p>Cluster Status: " + obj.Status + "</p><p>Cluster ID: " + obj.ID + "</p>"}
      document.getElementById("modal-title").innerText = obj.ClusterName;
      document.getElementById("modal-body").innerHTML = modalBodyHTML;
      document.getElementById("modal-header").style.backgroundColor = getColorCode(obj.Status);
    }

    function getColorCode(status) {
      console.log(status);
      if (status == "Running") { return "#4CAF50"; }
      if (status == "Pending") { return "#E67E22"; }
      if (status == "Failed") { return "#E74C3C"; }
    }


  </script>
</head>

<body onload="myFunction()">
  <div class="jumbotron px-2" style="background-color:RoyalBlue;color:white;  margin: 0 auto">
    <h1 class=" display-3">Openshift on Power</h1>
    <p>Build your own Openshift Container Platform Cluster on Power</p>
  </div>
  <nav class="navbar navbar-expand-xl" style="background-color:#6988E7; margin: 0 auto ;padding-left: 10px">
    <form class="form-inline my-2 my-lg-0">
      <div class="form-group required pt-md-3 d-none">
        <label class="control-label" for="emailid"><b>Login Email</b></label>
        <input type="text" class="form-control" id="emailid" name="emailid" placeholder="Emailid">
      </div>
      <button id="create-cluster-tab" formaction="/create" formmethod="post" class="btn btn-light " type="submit"> <svg
          xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-cloud-plus"
          viewBox="0 0 16 16">
          <path fill-rule="evenodd"
            d="M8 5.5a.5.5 0 0 1 .5.5v1.5H10a.5.5 0 0 1 0 1H8.5V10a.5.5 0 0 1-1 0V8.5H6a.5.5 0 0 1 0-1h1.5V6a.5.5 0 0 1 .5-.5z" />
          <path
            d="M4.406 3.342A5.53 5.53 0 0 1 8 2c2.69 0 4.923 2 5.166 4.579C14.758 6.804 16 8.137 16 9.773 16 11.569 14.502 13 12.687 13H3.781C1.708 13 0 11.366 0 9.318c0-1.763 1.266-3.223 2.942-3.593.143-.863.698-1.723 1.464-2.383zm.653.757c-.757.653-1.153 1.44-1.153 2.056v.448l-.445.049C2.064 6.805 1 7.952 1 9.318 1 10.785 2.23 12 3.781 12h8.906C13.98 12 15 10.988 15 9.773c0-1.216-1.02-2.228-2.313-2.228h-.5v-.5C12.188 4.825 10.328 3 8 3a4.53 4.53 0 0 0-2.941 1.1z" />
        </svg> Create
        Cluster</button>
      <button id="refresh-stack-tab" formaction="/refresh" formmethod="post" class="btn btn-light" type="submit"> <svg
          xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-clockwise"
          viewBox="0 0 16 16">
          <path fill-rule="evenodd" d="M8 3a5 5 0 1 0 4.546 2.914.5.5 0 0 1 .908-.417A6 6 0 1 1 8 2v1z" />
          <path
            d="M8 4.466V.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384L8.41 4.658A.25.25 0 0 1 8 4.466z" />
        </svg> Refresh
        Clusters</button>
      <button id="logout" formaction="/" formmethod="get" class="btn btn-light" type="submit"><svg
          xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-bar-right"
          viewBox="0 0 16 16">
          <path fill-rule="evenodd"
            d="M6 8a.5.5 0 0 0 .5.5h5.793l-2.147 2.146a.5.5 0 0 0 .708.708l3-3a.5.5 0 0 0 0-.708l-3-3a.5.5 0 0 0-.708.708L12.293 7.5H6.5A.5.5 0 0 0 6 8zm-2.5 7a.5.5 0 0 1-.5-.5v-13a.5.5 0 0 1 1 0v13a.5.5 0 0 1-.5.5z" />
        </svg> Logout</button>
    </form>
  </nav>

  <br />
  <div id="mainStacksContainer" class="float-container">
  </div>
  <br />
  <div class="modal fade" id="exampleModal">
    <div class="modal-dialog">
      <div class="modal-content">
        <div id="modal-header" class="modal-header" style="background-color: #F8C471">
          <h4 id="modal-title" class="modal-title">
          </h4>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">
              ×</span>
          </button>
        </div>
        <div id="modal-body" class="modal-body">
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">
            Close</button>
        </div>
      </div>
    </div>
  </div>
  </div>
</body>

</html>
